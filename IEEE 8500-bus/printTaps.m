CurrentDirectory=pwd;
cd('/Users/hafez/Documents/MATLAB/ThreePhaseVRs/Journal/IEEE 8500-bus/Results/');
IEEE8500=load('FinalRun'); 
CYI=IEEE8500.CYISolved.Branch.Wye3PhiTaps;
CYG=IEEE8500.CYGSolved.Branch.Wye3PhiTaps; 
BYM=IEEE8500.BYMSolved.Branch.Wye3PhiTaps; 
BCM=IEEE8500.BCMSolved.Branch.ClosedDeltaTaps;
% BOM=IEEE8500.CvxNetworkBOMRSolved.Branch.OpenDeltaTaps;
BOM=zeros(3,4); 

cd(CurrentDirectory); 

FileName=['TapsPrinted','.txt'];
FileID=fopen(FileName,'w');
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n',...
 'Method', 'CYI','CYG','BYM','BCM','BOM');
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n', ...
    '8500-1', [num2str(CYI(1,1)), ',',num2str(CYI(2,1)),',',num2str(CYI(3,1))],...
   [num2str(CYG(1,1)), ',',num2str(CYG(2,1)),',',num2str(CYG(3,1))],...
  [num2str(BYM(1,1)), ',',num2str(BYM(2,1)),',',num2str(BYM(3,1))],...
  [num2str(BCM(1,1)), ',',num2str(BCM(2,1)),',',num2str(BCM(3,1))],...
  [num2str(BOM(1,1)), ',',num2str(0),',',num2str(BOM(2,1))]);
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n', ...
    '8500-2', [num2str(CYI(1,2)), ',',num2str(CYI(2,2)),',',num2str(CYI(3,2))],...
   [num2str(CYG(1,2)), ',',num2str(CYG(2,2)),',',num2str(CYG(3,2))],...
  [num2str(BYM(1,2)), ',',num2str(BYM(2,2)),',',num2str(BYM(3,2))],...
  [num2str(BCM(1,2)), ',',num2str(BCM(2,2)),',',num2str(BCM(3,2))],...
  [num2str(BOM(1,2)), ',',num2str(0),',',num2str(BOM(2,2))]);
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n', ...
    '8500-3', [num2str(CYI(1,3)), ',',num2str(CYI(2,3)),',',num2str(CYI(3,3))],...
   [num2str(CYG(1,3)), ',',num2str(CYG(2,3)),',',num2str(CYG(3,3))],...
  [num2str(BYM(1,3)), ',',num2str(BYM(2,3)),',',num2str(BYM(3,3))],...
  [num2str(BCM(1,3)), ',',num2str(BCM(2,3)),',',num2str(BCM(3,3))],...
  [num2str(BOM(1,3)), ',',num2str(0),',',num2str(BOM(2,3))]);
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n', ...
    '8500-4', [num2str(CYI(1,4)), ',',num2str(CYI(2,4)),',',num2str(CYI(3,4))],...
   [num2str(CYG(1,4)), ',',num2str(CYG(2,4)),',',num2str(CYG(3,4))],...
  [num2str(BYM(1,4)), ',',num2str(BYM(2,4)),',',num2str(BYM(3,4))],...
  [num2str(BCM(1,4)), ',',num2str(BCM(2,4)),',',num2str(BCM(3,4))],...
  [num2str(BOM(1,4)), ',',num2str(0),',',num2str(BOM(2,4))]);
fclose(FileID);