CurrentDirectory=pwd;
cd('/Users/hafez/Documents/MATLAB/ThreePhaseVRs/Journal/ieee 123-bus/Results/');
IEEE123=load('FinalRun'); 
CYI=IEEE123.CYISolved.Branch.Wye3PhiTaps;
CYI2Phi=IEEE123.CYISolved.Branch.Wye2PhiTaps;
CYI1Phi=IEEE123.CYISolved.Branch.Wye1PhiTaps;



CYG=IEEE123.CYGSolved.Branch.Wye3PhiTaps; 
CYG2Phi=IEEE123.CYGSolved.Branch.Wye2PhiTaps; 
CYG1Phi=IEEE123.CYGSolved.Branch.Wye1PhiTaps; 

BYM=IEEE123.BYMSolved.Branch.Wye3PhiTaps; 
BYM2Phi=IEEE123.BYMSolved.Branch.Wye2PhiTaps; 
BYM1Phi=IEEE123.BYMSolved.Branch.Wye1PhiTaps; 

BCM=IEEE123.BCMSolved.Branch.ClosedDeltaTaps;
BCM2Phi=IEEE123.BCMSolved.Branch.Wye2PhiTaps; 
BCM1Phi=IEEE123.BCMSolved.Branch.Wye1PhiTaps; 

BOM=IEEE123.BOMSolved.Branch.OpenDeltaTaps;
BOM2Phi=IEEE123.BOMSolved.Branch.Wye2PhiTaps; 
BOM1Phi=IEEE123.BOMSolved.Branch.Wye1PhiTaps; 

cd(CurrentDirectory); 

FileName=['TapsPrinted','.txt'];
FileID=fopen(FileName,'w');
fprintf(FileID,' %-20s & %-20s  & %-20s  %-20s  & %-20s  & %-20s\n',...
 'SVR-ID', 'CYI','CYG','BYM','BCM','BOM');
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n', ...
    '123-1', [num2str(CYI(1,1)), ',',num2str(CYI(2,1)),',',num2str(CYI(3,1))],...
   [num2str(CYG(1,1)), ',',num2str(CYG(2,1)),',',num2str(CYG(3,1))],...
  [num2str(BYM(1,1)), ',',num2str(BYM(2,1)),',',num2str(BYM(3,1))],...
  [num2str(BCM(1,1)), ',',num2str(BCM(2,1)),',',num2str(BCM(3,1))],...
  [num2str(BOM(1,1)), ',',num2str(0),',',num2str(BOM(2,1))]);
fprintf(FileID,' %-20s & %-20s   & %-20s  %-20s  & %-20s  & %-20s\n', ...
    '123-2', [num2str(CYI1Phi(1,1))],...
   [num2str(CYG1Phi(1,1))],...
  [num2str(BYM1Phi(1,1))],...
  [num2str(BCM1Phi(1,1))],...
  [num2str(BOM1Phi(1,1))]);
fprintf(FileID,' %-20s & %-20s  & %-20s & %-20s  %-20s  & %-20s  \n', ...
    '123-3', [num2str(CYI2Phi(1,1)), ',',num2str(CYI2Phi(2,1))],...
   [num2str(CYG2Phi(1,1)), ',',num2str(CYG2Phi(2,1))],...
   [num2str(BYM2Phi(1,1)), ',',num2str(BYM2Phi(2,1))],...
   [num2str(BCM2Phi(1,1)), ',',num2str(BCM2Phi(2,1))],...
   [num2str(BOM2Phi(1,1)), ',',num2str(BOM2Phi(2,1))]);
fprintf(FileID,' %-20s & %-20s  & %-20s  %-20s  & %-20s  & %-20s\n', ...
    '123-4', [num2str(CYI(1,2)), ',',num2str(CYI(2,2)),',',num2str(CYI(3,2))],...
   [num2str(CYG(1,2)), ',',num2str(CYG(2,2)),',',num2str(CYG(3,2))],...
  [num2str(BYM(1,2)), ',',num2str(BYM(2,2)),',',num2str(BYM(3,2))],...
  [num2str(BCM(1,2)), ',',num2str(BCM(2,2)),',',num2str(BCM(3,2))],...
  [num2str(BOM(1,2)), ',',num2str(0),',',num2str(BOM(2,2))]);
fclose(FileID);